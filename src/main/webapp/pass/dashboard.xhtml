<?xml version="1.0" encoding="UTF-8"?>
<!--
  Created by IntelliJ IDEA.
  User: scottmat
  Date: 5/3/12
  Time: 3:07 PM
-->
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">


<h:head>
    <title>SequeL PASS Dashboard</title>
</h:head>

<h:body>
    <ui:composition template="/layout.xhtml">
        <ui:define name="title">SequeL PASS Dashboard</ui:define>
        <ui:define name="body">

            <h:form id="form">

                <h:panelGrid columns="2">

                    <h:panelGrid columns="2">
                        <p:selectBooleanCheckbox value="#{passDashboard.onlyMine}" >
                            <p:ajax event="click" listener="#{passDashboard.onOnlyMine}" update="dataTable" global="true"/>
                        </p:selectBooleanCheckbox>
                        <h:outputText value="Only mine" />
                    </h:panelGrid>

                    <h:panelGrid columns="2">
                        <p:selectBooleanCheckbox value="#{passDashboard.onlyActive}" >
                            <p:ajax event="click" listener="#{passDashboard.onOnlyActive}" update="dataTable" global="true"/>
                        </p:selectBooleanCheckbox>
                        <h:outputText value="Only active" />
                    </h:panelGrid>

                </h:panelGrid>

                <!-- Datatable seems to require containment in a form, probably for AJAX reasons.
                     Without a form there is silent failure. -->

                <p:dataTable id="dataTable" value="#{passDashboard.summarizedPassModel}" var="pass" widgetVar="dataTable"
                             emptyMessage="No PASSes found containing search text"
                             selection="#{passDashboard.selectedSummarizedPass}" selectionMode="single"
                             paginator="true" rows="15"
                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="10,15,25">

                    <p:ajax event="rowSelect" listener="#{passDashboard.onRowSelect}" update=":form:display" oncomplete="passDialog.show()" />
                    <p:ajax event="rowUnselect" listener="#{passDashboard.onRowUnselect}" />

                    <f:facet name="header">
                        <p:outputPanel>
                            <h:outputText value="Search PASS number + title:" />
                            <p:inputText id="globalFilter" onkeyup="dataTable.filter()" style="width:150px" />
                        </p:outputPanel>
                    </f:facet>

                    <p:column sortBy="#{pass.passNumber}" sortFunction="#{passDashboard.sortByPassNumber}" filterBy="#{pass.passNumber}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="Number"/>
                        </f:facet>
                        <h:outputText value="#{pass.passNumber} ver #{pass.version}"/>
                    </p:column>
                    <p:column sortBy="#{pass.title}" filterBy="#{pass.title}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="Title"/>
                        </f:facet>
                        <h:outputText value="#{pass.title}"/>
                    </p:column>
<!-- R3_725
                    <p:column sortBy="#{pass.createdDate}" sortFunction="#{passDashboard.sortByCalendar}">
                        <f:facet name="header">
                            <h:outputText value="Created" />
                        </f:facet>
                        <h:outputText value="#{passDashboard.format(pass.createdDate)}" />
                    </p:column>
-->
                    <p:column sortBy="#{pass.lastModified}" sortFunction="#{passDashboard.sortByCalendar}">
                        <f:facet name="header">
                            <h:outputText value="Updated" />
                        </f:facet>
                        <h:outputText value="#{passDashboard.format(pass.lastModified)}" />
                    </p:column>
                </p:dataTable>


                <p:dialog id="passDialog" header="PASS Detail" widgetVar="passDialog" resizable="true"
                          hideEffect="fade" modal="true">

                    <p:panelGrid id="display" cellpadding="4" >



                        <f:facet name="header">
                            <p:row>
                                <p:column colspan="3">
                                    <h:outputText value="#{passDashboard.projectInfo.passNumber} version #{passDashboard.projectInfo.version}" />
                                </p:column>
                            </p:row>
                        </f:facet>


                        <p:row>
                            <p:column colspan="3">
                                <span class="pass-section">Project</span>
                            </p:column>
                        </p:row>

                        <p:row>
                            <p:column>
                                <span class="pass-label">PASS Number:</span>
                                <span class="pass-data">#{passDashboard.projectInfo.passNumber}</span>
                            </p:column>
                            <p:column>
                                <span class="pass-label">Version:</span>
                                <span class="pass-data">#{passDashboard.projectInfo.version}</span>
                            </p:column>
                            <p:column>
                                <span class="pass-label">PASS Type:</span>
                                <span class="pass-data">#{passDashboard.passType}</span>
                            </p:column>
                        </p:row>

                        <p:row>
                            <p:column colspan="3">
                                <span class="pass-label">Research Project:</span>
                                <span class="pass-data">#{passDashboard.selectedPass.researchProject}</span>
                            </p:column>
                        </p:row>

                        <p:row>
                            <p:column colspan="2">
                                <span class="pass-label">Title:</span>
                                <span class="pass-data">#{passDashboard.projectInfo.title}</span>
                            </p:column>
                            <p:column>
                                <span class="pass-label">Nickname:</span>
                                <span class="pass-data">#{passDashboard.projectInfo.nickname}</span>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column>
                                <span class="pass-label">Creator:</span>
                                <span class="pass-data">#{passDashboard.selectedPass.creator}</span>
                            </p:column>
                            <p:column>
                                <span class="pass-label">Date Created:</span>
                                <span class="pass-data">#{passDashboard.createdDate}</span>
                            </p:column>
                            <p:column>
                                <span class="pass-label">Last Modified:</span>
                                <span class="pass-data">#{passDashboard.modifiedDate}</span>
                            </p:column>
                        </p:row>


                        <p:row >
                            <p:column colspan="3">
                                <p:dataTable id="sampleTable" value="#{passDashboard.passSampleDataModel}" var="passSample" widgetVar="sampleTable"
                                             emptyMessage="No samples found with IDs matching search criteria"
                                             paginator="true" rows="15"
                                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             rowsPerPageTemplate="10, 15">

                                    <f:facet name="header">
                                        <p:outputPanel>
                                            <h:outputText value="Search sample ID:" />
                                            <p:inputText id="globalFilter" onkeyup="sampleTable.filter()" style="width:150px" />
                                        </p:outputPanel>
                                    </f:facet>

                                    <p:column sortBy="#{passSample.sampleId}" filterBy="#{passSample.sampleId}" filterMatchMode="contains">
                                        <f:facet name="header">
                                            Sample ID
                                        </f:facet>
                                        <h:outputText value="#{passSample.sampleId}"/>
                                    </p:column>
                                    <p:column sortBy="#{passSample.volume}"
                                              sortFunction="#{passDashboard.sortFloatingPoint}">
                                        <f:facet name="header">
                                            Volume
                                        </f:facet>
                                        <h:outputText value="#{passSample.volume}"/>
                                    </p:column>

                                </p:dataTable>
                            </p:column>
                        </p:row>

                    </p:panelGrid>

                </p:dialog>


            </h:form>
        </ui:define>
    </ui:composition>

</h:body>

</html>
