<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">

    <!-- changeSet ids include the ticket number, with -n appended to allow multiple changeSets per ticket.
     Keep changeSets small, it's harder to recover from an error in a large changeSet.
      -->
    <!--
        <changeSet id="GPLIM-55-1" author="thompson">
            <preConditions>
                <not>
                    <tableExists tableName="test" schemaName="mercury"/>
                </not>
            </preConditions>
            <comment>Testing Liquibase</comment>
            <createTable tableName="test" schemaName="mercury">
                <column name="test_id" type="int">
                    <constraints primaryKey="true" nullable="false"/>
                </column>
                <column name="name" type="varchar(50)">
                    <constraints nullable="false"/>
                </column>
                <column name="active" type="boolean" defaultValueBoolean="true"/>
            </createTable>
        </changeSet>
    -->

    <changeSet id="GPLIM-73-1" author="thompson">
        <createTable tableName="lab_vessel_mercury_samples" schemaName="mercury">
            <column name="lab_vessel" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="mercury_samples" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="lab_vessel_mercury_samples" schemaName="mercury" columnNames="lab_vessel, mercury_samples"/>
    </changeSet>
    <changeSet id="GPLIM-73-2" author="thompson">
        <createTable tableName="lab_vessel_mercury_samples_aud" schemaName="mercury">
            <column name="rev" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="lab_vessel" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="mercury_samples" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="revtype" type="number(3,0)">
                <constraints nullable="true"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="lab_vessel_mercury_samples_aud" schemaName="mercury" columnNames="rev, lab_vessel, mercury_samples"/>
    </changeSet>
    <changeSet id="GPLIM-73-3" author="thompson">
        <createTable tableName="mercury_sample" schemaName="mercury">
            <column name="mercury_sample_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="product_order_key" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
            <column name="sample_key" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="mercury_sample" schemaName="mercury" columnNames="mercury_sample_id"/>
        <createIndex tableName="mercury_sample" indexName="ix_ms_sample_key">
            <column name="sample_key"/>
        </createIndex>
        <createSequence sequenceName="SEQ_MERCURY_SAMPLE" schemaName="mercury" startValue="1" incrementBy="50"/>
    </changeSet>
    <changeSet id="GPLIM-73-4" author="thompson">
        <createTable tableName="mercury_sample_aud" schemaName="mercury">
            <column name="mercury_sample_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="rev" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="revtype" type="number(3,0)">
                <constraints nullable="true"/>
            </column>
            <column name="product_order_key" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
            <column name="sample_key" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="mercury_sample_aud" schemaName="mercury" columnNames="mercury_sample_id, rev"/>
    </changeSet>
    <changeSet id="GPLIM-73-5" author="thompson">
        <addForeignKeyConstraint baseTableName="lab_vessel_mercury_samples" baseTableSchemaName="mercury"
                                 baseColumnNames="mercury_samples"
                                 constraintName="fk_lvms_mercury_sample"
                                 referencedTableName="mercury_sample" referencedTableSchemaName="mercury"
                                 referencedColumnNames="mercury_sample_id"/>
        <addForeignKeyConstraint baseTableName="lab_vessel_mercury_samples" baseTableSchemaName="mercury"
                                 baseColumnNames="lab_vessel"
                                 constraintName="fk_lvms_lab_vessel"
                                 referencedTableName="lab_vessel" referencedTableSchemaName="mercury"
                                 referencedColumnNames="lab_vessel_id"/>
        <addForeignKeyConstraint baseTableName="lab_vessel_mercury_samples_aud" baseTableSchemaName="mercury"
                                 baseColumnNames="rev"
                                 constraintName="fk_lvmsa_rev_info"
                                 referencedTableName="rev_info" referencedTableSchemaName="mercury"
                                 referencedColumnNames="rev_info_id"/>
    </changeSet>

    <changeSet id="GPLIM-73-6" author="thompson">
        <addColumn tableName="lab_vessel" schemaName="mercury">
            <column name="volume" type="float"/>
            <column name="concentration" type="float"/>
        </addColumn>
        <addColumn tableName="lab_vessel_aud" schemaName="mercury">
            <column name="volume" type="float"/>
            <column name="concentration" type="float"/>
        </addColumn>
    </changeSet>
    <changeSet id="GPLIM-22-1" author="scottmat">
        <createTable tableName="bucket" schemaName="mercury">
            <column name="bucket_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="bucket_definition_name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="bucket" schemaName="mercury" columnNames="bucket_id"/>
        <createSequence sequenceName="SEQ_BUCKET" schemaName="mercury" startValue="1" incrementBy="50"/>
        <createIndex tableName="bucket" indexName="ix_b_def_name">
            <column name="bucket_definition_name"/>
        </createIndex>
    </changeSet>
    <changeSet id="GPLIM-22-2" author="scottmat">
        <createTable tableName="bucket_aud" schemaName="mercury">
            <column name="bucket_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="rev" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="revtype" type="number(19,0)">
                <constraints nullable="true"/>
            </column>
            <column name="bucket_definition_name" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="bucket_aud" schemaName="mercury" columnNames="bucket_id, rev"/>
    </changeSet>
    <changeSet id="GPLIM-22-3" author="scottmat">
        <createTable tableName="bucket_entry" schemaName="mercury">
            <column name="bucket_entry_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="lab_vessel_id" type="number(19,0)">
                <!-- Foreign key to LabVessels -->
                <constraints nullable="false"/>
            </column>
            <column name="po_business_key" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="bucket_existence_id" type="number(19,0)">
                <!--foreign key to bucket -->
                <constraints nullable="true"/>
            </column>
            <column name="product_order_ranking" type="number(10,0)">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="oracle.sql.TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="bucket_entry" schemaName="mercury" columnNames="bucket_entry_id"/>
        <createIndex tableName="bucket_entry" indexName="ix_be_lab_vessel_id">
            <column name="lab_vessel_id"/>
        </createIndex>
        <createIndex tableName="bucket_entry" indexName="ix_be_bucket_existence_id">
            <column name="bucket_existence_id"/>
        </createIndex>
        <createSequence sequenceName="SEQ_BUCKET_ENTRY" schemaName="mercury" startValue="1" incrementBy="50"/>
    </changeSet>
    <changeSet id="GPLIM-22-4" author="scottmat">
        <createTable tableName="bucket_entry_aud" schemaName="mercury">
            <column name="bucket_entry_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="rev" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="revtype" type="number(19,0)">
                <constraints nullable="true"/>
            </column>
            <column name="lab_vessel_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="po_business_key" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="bucket_existence_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="product_order_ranking" type="number(10,0)">
                <constraints nullable="false"/>
            </column>
            <column name="created_date" type="oracle.sql.TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="bucket_entry_aud" schemaName="mercury" columnNames="bucket_entry_id, rev"/>
    </changeSet>
    <changeSet id="GPLIM-22-5" author="scottmat">
        <addForeignKeyConstraint baseTableName="bucket_entry" baseTableSchemaName="mercury"
                                 baseColumnNames="lab_vessel_id"
                                 constraintName="fk_be_lab_vessel_id"
                                 referencedTableName="lab_vessel" referencedTableSchemaName="mercury"
                                 referencedColumnNames="lab_vessel_id"/>
        <addForeignKeyConstraint baseTableName="bucket_entry" baseTableSchemaName="mercury"
                                 baseColumnNames="bucket_existence_id"
                                 constraintName="fk_be_bucket_existence_id"
                                 referencedTableName="bucket" referencedTableSchemaName="mercury"
                                 referencedColumnNames="bucket_id"/>
    </changeSet>
    <changeSet id="GPLIM-273-1" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="lab_event" columnName="product_order_id" schemaName="mercury"/>
            </not>
        </preConditions>
        <addColumn tableName="lab_event">
            <column name="product_order_id" type="varchar(255)"/>
        </addColumn>
    </changeSet>
    <changeSet id="GPLIM-273-2" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="lab_event_aud" columnName="product_order_id" schemaName="mercury"/>
            </not>
        </preConditions>
        <addColumn tableName="lab_event_aud">
            <column name="product_order_id" type="varchar(255)"/>
        </addColumn>
    </changeSet>
    <changeSet id="GPLIM-273-3" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="lab_batch" columnName="created_on" schemaName="mercury"/>
            </not>
        </preConditions>
        <addColumn tableName="lab_batch">
            <column name="created_on" type="oracle.sql.TIMESTAMP"/>
        </addColumn>

    </changeSet>
    <changeSet id="GPLIM-273-4" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="lab_batch_aud" columnName="created_on" schemaName="mercury"/>
            </not>
        </preConditions>
        <addColumn tableName="lab_batch_aud">
            <column name="created_on" type="oracle.sql.TIMESTAMP"/>
        </addColumn>
    </changeSet>

    <changeSet id="GPLIM-73-7" author="thompson">
        <dropColumn tableName="lab_event" columnName="dtype" schemaName="mercury"/>
    </changeSet>
    <changeSet id="GPLIM-73-8" author="thompson">
        <dropColumn tableName="lab_event_aud" columnName="dtype" schemaName="mercury"/>
    </changeSet>
    <changeSet id="GPLIM-73-10" author="thompson">
        <addUniqueConstraint tableName="molecular_indexing_scheme" columnNames="name"
                             constraintName="uk_mis_name" schemaName="mercury"/>
    </changeSet>

    <changeSet id="GPLIM-362-1" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyName="FKD13659683B570EF2" schemaName="mercury"/>
        </preConditions>
        <dropForeignKeyConstraint
                constraintName="FKD13659683B570EF2" baseTableName="lab_event"/>
    </changeSet>
    <changeSet id="GPLIM-362-2" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyName="FKB8B4430A746A02ED" schemaName="mercury"/>
        </preConditions>
        <dropForeignKeyConstraint
                constraintName="FKB8B4430A746A02ED" baseTableName="sequencing_run"/>
    </changeSet>

    <!--
    todo jmt enable these constraints
    <changeSet id="GPLIM-73-9" author="thompson">
        <addUniqueConstraint tableName="molecular_index_position" columnNames="SCHEME_ID, POSITION_HINT"
                             constraintName="uk_mip_scheme_position" schemaName="mercury"/>
    </changeSet>
-->
    <changeSet id="GPLIM-73-11" author="thompson">
        <addUniqueConstraint tableName="molecular_index" columnNames="sequence"
                             constraintName="uk_mi_sequence" schemaName="mercury"/>
    </changeSet>

    <changeSet id="GPLIM-73-12" author="thompson">
        <createTable tableName="reagent_design" schemaName="mercury">
            <column name="reagent_design_id" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="manufacturers_name" type="varchar2(255)"/>
            <column name="reagent_design" type="varchar2(255)"/>
            <column name="reagent_type" type="varchar2(255)"/>
            <column name="target_set_name" type="varchar2(255)"/>
        </createTable>
        <createSequence sequenceName="SEQ_REAGENT_DESIGN" schemaName="mercury" startValue="1" incrementBy="50"/>
    </changeSet>
    <changeSet id="GPLIM-73-13" author="thompson">
        <createTable tableName="reagent_design_aud">
            <column name="reagent_design_id" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="rev" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="revtype" type="number(3,0)"/>
            <column name="manufacturers_name" type="varchar2(255)"/>
            <column name="reagent_design" type="varchar2(255)"/>
            <column name="reagent_type" type="varchar2(255 char)"/>
            <column name="target_set_name" type="varchar2(255)"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="reagent_design_aud" baseTableSchemaName="mercury"
                                 baseColumnNames="rev"
                                 constraintName="fk_rd_rev_info"
                                 referencedTableName="rev_info" referencedTableSchemaName="mercury"
                                 referencedColumnNames="rev_info_id"/>
    </changeSet>
    <changeSet id="GPLIM-73-14" author="thompson">
        <addColumn tableName="reagent" schemaName="mercury">
            <column name="reagent_design" type="number(19,0)"/>
        </addColumn>
        <addForeignKeyConstraint baseTableName="reagent" baseColumnNames="reagent_design"
                                 constraintName="fk_r_reagent_design"
                                 referencedTableName="reagent_design"
                                 referencedColumnNames="reagent_design_id"/>
    </changeSet>
    <changeSet id="GPLIM-73-15" author="thompson">
        <addColumn tableName="reagent_aud" schemaName="mercury">
            <column name="reagent_design" type="number(19,0)"/>
        </addColumn>
    </changeSet>

    <changeSet id="GPLIM-73-16" author="thompson">
        <createTable tableName="lab_vessel_racks_of_tubes" schemaName="mercury">
            <column name="lab_vessel" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="racks_of_tubes" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
        </createTable>
        <addForeignKeyConstraint baseTableName="lab_vessel_racks_of_tubes" baseColumnNames="racks_of_tubes"
                                 constraintName="fk_lvrt_rack_of_tubes" referencedTableName="lab_vessel"
                                 referencedColumnNames="lab_vessel_id"/>
        <addForeignKeyConstraint baseTableName="lab_vessel_racks_of_tubes" baseColumnNames="lab_vessel"
                                 constraintName="fk_lvrt_lab_vessel" referencedTableName="lab_vessel"
                                 referencedColumnNames="lab_vessel_id"/>
    </changeSet>
    <changeSet id="GPLIM-73-17" author="thompson">
        <createTable tableName="lab_vessel_racks_of_tubes_aud" schemaName="mercury">
            <column name="rev" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="lab_vessel" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="racks_of_tubes" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="revtype" type="number(3,0)"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="lab_vessel_racks_of_tubes_aud" baseColumnNames="rev"
                                 constraintName="fk_lvrta_rev_info" referencedTableName="rev_info"
                                 referencedColumnNames="rev_info_id"/>
    </changeSet>

    <changeSet id="GPLIM-378-1" author="scottmat">
        <preConditions>
            <tableExists tableName="person" schemaName="mercury"/>
        </preConditions>
        <dropTable tableName="person" schemaName="mercury"/>
    </changeSet>

    <changeSet id="GPLIM-378-2" author="scottmat">
        <preConditions>
            <tableExists tableName="person_aud" schemaName="mercury"/>
        </preConditions>
        <dropTable tableName="person_aud" schemaName="mercury"/>
    </changeSet>
    <changeSet id="GPLIM-308-11" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists schemaName="mercury" indexName="uk_reagent_design"/>
            </not>

        </preConditions>
        <addUniqueConstraint tableName="reagent_design" columnNames="reagent_design,reagent_type"
                             constraintName="uk_reagent_design" schemaName="mercury"/>
    </changeSet>

    <changeSet id="GPLIM-849-1" author="thompson">
        <createTable tableName="lab_metric" schemaName="mercury">
            <column name="lab_metric_id" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="lab_unit" type="varchar2(255)"/>
            <column name="metric_type" type="varchar2(255)"/>
            <column name="value" type="number(19,2)"/>
            <column name="lab_metric_run" type="number(19,0)"/>
            <column name="lab_vessel" type="number(19,0)"/>
        </createTable>
    </changeSet>

    <changeSet id="GPLIM-849-2" author="thompson">
        <createTable tableName="lab_metric_aud" schemaName="mercury">
            <column name="lab_metric_id" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="rev" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="revtype" type="number(3,0)"/>
            <column name="lab_unit" type="varchar2(255)"/>
            <column name="metric_type" type="varchar2(255)"/>
            <column name="value" type="number(19,2)"/>
            <column name="lab_metric_run" type="number(19,0)"/>
            <column name="lab_vessel" type="number(19,0)"/>
        </createTable>
    </changeSet>

    <changeSet id="GPLIM-849-3" author="thompson">
        <createTable tableName="lab_metric_run" schemaName="mercury">
            <column name="lab_metric_run_id" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="metric_type" type="varchar2(255)"/>
            <column name="run_date" type="timestamp"/>
            <column name="run_name" type="varchar2(255)"/>
        </createTable>
        <addUniqueConstraint tableName="lab_metric_run" schemaName="mercury"
                             columnNames="run_name, run_date" constraintName="uk_lmr_name_date"/>
    </changeSet>

    <changeSet id="GPLIM-849-4" author="thompson">
        <createTable tableName="lab_metric_run_aud" schemaName="mercury">
            <column name="lab_metric_run_id" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="rev" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>
            <column name="revtype" type="number(3,0)"/>
            <column name="metric_type" type="varchar2(255)"/>
            <column name="run_date" type="timestamp"/>
            <column name="run_name" type="varchar2(255)"/>
        </createTable>
    </changeSet>

    <changeSet id="GPLIM-849-5" author="thompson">
        <addForeignKeyConstraint baseTableName="lab_metric" baseTableSchemaName="mercury" baseColumnNames="lab_metric_run"
                                 constraintName="fk_lm_lab_metric_run"
                                 referencedTableName="lab_metric_run" referencedTableSchemaName="mercury"
                                 referencedColumnNames="lab_metric_run_id"/>
        <addForeignKeyConstraint baseTableName="lab_metric" baseTableSchemaName="mercury" baseColumnNames="lab_vessel"
                                 constraintName="fk_lm_lab_vessel"
                                 referencedTableName="lab_vessel" referencedTableSchemaName="mercury"
                                 referencedColumnNames="lab_vessel_id"/>
        <addForeignKeyConstraint baseTableName="lab_metric_aud" baseTableSchemaName="mercury" baseColumnNames="rev"
                                 constraintName="fk_lm_rev_info"
                                 referencedTableName="rev_info" referencedTableSchemaName="mercury"
                                 referencedColumnNames="rev_info_id"/>
        <addForeignKeyConstraint baseTableName="lab_metric_run_aud" baseTableSchemaName="mercury" baseColumnNames="rev"
                                 constraintName="fk_lmr_rev_info"
                                 referencedTableName="rev_info" referencedTableSchemaName="mercury"
                                 referencedColumnNames="rev_info_id"/>
    </changeSet>

    <changeSet id="GPLIM-849-6" author="thompson">
        <createSequence sequenceName="SEQ_LAB_METRIC" schemaName="mercury" startValue="1" incrementBy="50"/>
        <createSequence sequenceName="SEQ_LAB_METRIC_RUN" schemaName="mercury" startValue="1" incrementBy="50"/>
    </changeSet>


    <changeSet id="GPLIM-765-01" author="dryan" >
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="lv_comment" schemaName="mercury"/>
            </not>
        </preConditions>

        <createTable tableName="lv_comment" schemaName="mercury">
            <column name="lab_vessel_comment_id" type="number(19,0)">
                <constraints primaryKey="true"/>
            </column>

            <column name="lab_vessel_comment" type="varchar2(255)"/>
            <column name="log_date" type="oracle.sql.TIMESTAMP">
                <constraints nullable="false"/>
            </column>

            <column name="lab_event" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="lab_vessel" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createSequence sequenceName="SEQ_LV_COMMENT" schemaName="mercury" startValue="1" incrementBy="50"/>
        <addForeignKeyConstraint baseTableName="lv_comment" baseColumnNames="lab_event" baseTableSchemaName="mercury"
                                 constraintName="fk_lv_comment_lab_event"
                                 referencedTableName="lab_event"
                                 referencedColumnNames="lab_event_id"/>
        <addForeignKeyConstraint baseTableName="lv_comment" baseColumnNames="lab_vessel" baseTableSchemaName="mercury"
                                 constraintName="fk_lv_comment_lv"
                                 referencedTableName="lab_vessel"
                                 referencedColumnNames="lab_vessel_id"/>
    </changeSet>


    <changeSet id="GPLIM-765-02.0" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="lv_comment_aud" schemaName="mercury"/>
            </not>
        </preConditions>

        <createTable tableName="lv_comment_aud" schemaName="mercury">
            <column name="lab_vessel_comment_id" type="number(19,0)">
            </column>

            <column name="lab_vessel_comment" type="varchar2(255)"/>
            <column name="log_date" type="oracle.sql.TIMESTAMP">
                <constraints nullable="false"/>
            </column>

            <column name="lab_event" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="lab_vessel" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="rev" type="number(19,0)">
            </column>
            <column name="revtype" type="number(3,0)"/>

        </createTable>
        <addPrimaryKey tableName="lv_comment_aud" schemaName="mercury" columnNames="lab_vessel_comment_id, rev"/>
    </changeSet>

    <changeSet id="GPLIM-765-03" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="lv_pos" schemaName="mercury"/>
            </not>
        </preConditions>

        <createTable tableName="lv_pos" schemaName="mercury">
            <column name="lab_vessel_position_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="vessel_position" type="varchar2(255)"/>
        </createTable>
        <addPrimaryKey schemaName="mercury" tableName="lv_pos" columnNames="lab_vessel_position_id"/>
        <createSequence sequenceName="SEQ_LV_POS" schemaName="mercury" startValue="1" incrementBy="50"/>
    </changeSet>

    <changeSet id="GPLIM-765-04" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="lv_pos_aud" schemaName="mercury"/>
            </not>
        </preConditions>

        <createTable tableName="lv_pos_aud" schemaName="mercury">
            <column name="lab_vessel_position_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="vessel_position" type="varchar2(255)"/>
            <column name="rev" type="number(19,0)"/>
            <column name="revtype" type="number(3,0)"/>
        </createTable>
        <addPrimaryKey schemaName="mercury" tableName="lv_pos_aud" columnNames="lab_vessel_position_id, rev"/>
    </changeSet>

    <changeSet id="GPLIM-765-05" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="rap_sheet" schemaName="mercury"/>
            </not>
        </preConditions>

        <createTable tableName="rap_sheet" schemaName="mercury">
            <column name="rap_sheet_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addPrimaryKey schemaName="mercury" tableName="rap_sheet" columnNames="rap_sheet_id"/>
        <createSequence sequenceName="SEQ_RAP_SHEET" schemaName="mercury" startValue="1" incrementBy="50"/>
    </changeSet>
    <changeSet id="GPLIM-765-06" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="rap_sheet_aud" schemaName="mercury"/>
            </not>
        </preConditions>

        <createTable tableName="rap_sheet_aud" schemaName="mercury">
            <column name="rap_sheet_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="rev" type="number(19,0)"/>
            <column name="revtype" type="number(3,0)"/>
        </createTable>

        <addPrimaryKey schemaName="mercury" tableName="rap_sheet_aud" columnNames="rap_sheet_id,rev"/>
    </changeSet>
    <changeSet id="GPLIM-765-07" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="rap_sheet_entry" schemaName="mercury"/>
            </not>
        </preConditions>

        <createTable tableName="rap_sheet_entry" schemaName="mercury">
            <column name="rap_sheet_entry_id" type="number(19,0)"> <constraints nullable="false"/> </column>
            <column name="dtype" type="varchar2(31)"><constraints nullable="false"/></column>
            <column name="rework_level" type="varchar2(255)"><constraints nullable="false"/></column>
            <column name="rework_reason" type="varchar2(255)"><constraints nullable="false"/></column>
            <column name="rework_step" type="varchar2(255)"><constraints nullable="false"/></column>
            <column name="lab_vessel_comment" type="number(19,0)"><constraints nullable="false"/></column>
            <column name="lab_vessel_position" type="number(19,0)"><constraints nullable="false"/></column>
            <column name="rap_sheet" type="number(19,0)"><constraints nullable="false"/></column>
        </createTable>
        <createSequence sequenceName="SEQ_RAP_SHEET_ENTRY" schemaName="mercury" startValue="1" incrementBy="50"/>

        <addPrimaryKey tableName="rap_sheet_entry" columnNames="rap_sheet_entry_id"/>
        <addForeignKeyConstraint baseTableName="rap_sheet_entry" baseTableSchemaName="mercury"
                                 baseColumnNames="lab_vessel_position"
                                 constraintName="fk_rs_ent_lv_pos"
                                 referencedTableName="lv_pos"
                                 referencedColumnNames="lab_vessel_position_id"/>
        <addForeignKeyConstraint baseTableName="rap_sheet_entry" baseTableSchemaName="mercury"
                                 baseColumnNames="rap_sheet"
                                 constraintName="fk_rs_ent_rs"
                                 referencedTableName="rap_sheet"
                                 referencedColumnNames="rap_sheet_id"/>
        <addForeignKeyConstraint baseTableName="rap_sheet_entry" baseTableSchemaName="mercury"
                                 baseColumnNames="lab_vessel_comment"
                                 constraintName="fk_rs_ent_lv_comment"
                                 referencedTableName="lv_comment" referencedTableSchemaName="mercury"
                                 referencedColumnNames="lab_vessel_comment_id"/>
    </changeSet>

    <changeSet id="GPLIM-765-08" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="rap_sheet_entry_aud" schemaName="mercury"/>
            </not>
        </preConditions>

        <createTable tableName="rap_sheet_entry_aud" schemaName="mercury">
            <column name="rap_sheet_entry_id" type="number(19,0)"> <constraints nullable="false"/> </column>
            <column name="dtype" type="varchar2(31)"><constraints nullable="false"/></column>
            <column name="rework_level" type="varchar2(255)"><constraints nullable="true"/></column>
            <column name="rework_reason" type="varchar2(255)"><constraints nullable="true"/></column>
            <column name="rework_step" type="varchar2(255)"><constraints nullable="true"/></column>
            <column name="lab_vessel_comment" type="number(19,0)"><constraints nullable="false"/></column>
            <column name="lab_vessel_position" type="number(19,0)"><constraints nullable="false"/></column>
            <column name="rap_sheet" type="number(19,0)"><constraints nullable="false"/></column>
            <column name="rev" type="number(19,0)"/>
            <column name="revtype" type="number(3,0)"/>
        </createTable>
        <addPrimaryKey tableName="rap_sheet_entry_aud" columnNames="rap_sheet_entry_id,rev"/>
    </changeSet>


    <changeSet id="GPLIM-765-09" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="lv_pos_mercury_samples" schemaName="mercury"/>
            </not>
        </preConditions>

        <createTable tableName="lv_pos_mercury_samples" schemaName="mercury">
            <column name="lv_pos" type="number(19,0)"> <constraints nullable="false"/> </column>
            <column name="mercury_samples" type="number(19,0)"> <constraints nullable="false"/> </column>
        </createTable>
        <addUniqueConstraint tableName="lv_pos_mercury_samples" columnNames="mercury_samples"/>
        <addForeignKeyConstraint baseTableName="lv_pos_mercury_samples" baseColumnNames="lv_pos"
                                 constraintName="fk_lv_pos_mercury_samples_pos"
                                 referencedTableName="lv_pos"
                                 referencedColumnNames="lab_vessel_position_id"/>
        <addForeignKeyConstraint baseTableName="lv_pos_mercury_samples" baseColumnNames="mercury_samples"
                                 constraintName="fk_lv_pos_mercury_samples_ms"
                                 referencedTableName="mercury_sample"
                                 referencedColumnNames="mercury_sample_id"/>
    </changeSet>

    <changeSet id="GPLIM-765-10" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="lv_pos_mercury_samples_aud" schemaName="mercury"/>
            </not>
        </preConditions>

        <createTable tableName="lv_pos_mercury_samples_aud" schemaName="mercury">
            <column name="lv_pos" type="number(19,0)"> <constraints nullable="false"/> </column>
            <column name="mercury_samples" type="number(19,0)"> <constraints nullable="false"/> </column>
            <column name="rev" type="number(19,0)"/>
            <column name="revtype" type="number(3,0)"/>
        </createTable>
        <addPrimaryKey tableName="lv_pos_mercury_samples_aud" columnNames="rev, lv_pos, mercury_samples"/>
    </changeSet>

    <changeSet id="GPLIM-765-11" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="mercury_sample" columnName="rap_sheet" schemaName="mercury"/>
            </not>
        </preConditions>
        <addColumn tableName="mercury_sample" schemaName="mercury">
            <column name="rap_sheet" type="number(19,0)"/>
        </addColumn>
        <addForeignKeyConstraint baseTableName="mercury_sample" baseColumnNames="rap_sheet"
                                 constraintName="fk_mercury_sample_rap_sheet"
                                 referencedTableName="rap_sheet"
                                 referencedColumnNames="rap_sheet_id"/>
    </changeSet>
    <changeSet id="GPLIM-765-12" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="mercury_sample_aud" columnName="rap_sheet" schemaName="mercury"/>
            </not>
        </preConditions>
        <addColumn tableName="mercury_sample_aud" schemaName="mercury">
            <column name="rap_sheet" type="number(19,0)"/>
        </addColumn>
    </changeSet>

    <changeSet id="GPLIM-914-1" author="thompson">
        <addColumn tableName="lab_batch">
            <column name="lab_batch_type" type="varchar2(255)"/>
        </addColumn>
    </changeSet>
    <changeSet id="GPLIM-914-2" author="thompson">
        <addColumn tableName="lab_batch_aud">
            <column name="lab_batch_type" type="varchar2(255)"/>
        </addColumn>
    </changeSet>

    <changeSet id="GPLIM-973-1" author="breilly">
        <dropNotNullConstraint tableName="bucket_entry_aud" columnName="lab_vessel_id"/>
        <dropNotNullConstraint tableName="bucket_entry_aud" columnName="po_business_key"/>
        <dropNotNullConstraint tableName="bucket_entry_aud" columnName="bucket_existence_id"/>
        <dropNotNullConstraint tableName="bucket_entry_aud" columnName="product_order_ranking"/>
        <dropNotNullConstraint tableName="bucket_entry_aud" columnName="created_date"/>
    </changeSet>

    <changeSet id="GPLIM-970-1" author="scottmat">
        <createTable tableName="mercury_control" schemaName="mercury">
            <column name="mercury_control_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="collaborator_sample_id" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
            <column name="type" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
            <column name="state" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="mercury_control" schemaName="mercury" columnNames="mercury_control_id"/>
        <createIndex tableName="mercury_control" indexName="ix_mc_sample_key" unique="true">
            <column name="collaborator_sample_id"/>
            <column name="state"/>
        </createIndex>
        <createSequence sequenceName="SEQ_MERCURY_CONTROL" schemaName="mercury" startValue="1" incrementBy="50"/>
    </changeSet>
    <changeSet id="GPLIM-970-2" author="scottmat">
        <createTable tableName="mercury_control_aud" schemaName="mercury">
            <column name="mercury_control_id" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="rev" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="revtype" type="number(3,0)">
                <constraints nullable="true"/>
            </column>
            <column name="collaborator_sample_id" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
            <column name="type" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
            <column name="state" type="varchar(255)">
                <constraints nullable="true"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="mercury_control_aud" schemaName="mercury" columnNames="mercury_control_id, rev"/>
    </changeSet>

    <changeSet id="GPLIM-1048-1" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists schemaName="mercury" tableName="output_data_location" />
            </not>
        </preConditions>

        <createTable tableName="output_data_location" schemaName="mercury">
            <column name="data_location_id" type="number(19,0)">
                <constraints nullable="false" />
            </column>
            <column name="data_location" type="varchar(255)">
                <constraints nullable="false" />
            </column>
            <column name="archived" type="number(1,0)" />
        </createTable>

        <addPrimaryKey tableName="output_data_location" schemaName="mercury" columnNames="data_location_id" />
        <createIndex tableName="output_data_location" indexName="ix_output_data_key">
            <column name="data_location" />
        </createIndex>
        <createSequence sequenceName="SEQ_DATA_LOCATION" schemaName="mercury" startValue="1" incrementBy="50" />

    </changeSet>
    <changeSet id="GPLIM-1048-2" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists schemaName="mercury" tableName="output_data_location_aud" />
            </not>
        </preConditions>

        <createTable tableName="output_data_location_aud" schemaName="mercury">
            <column name="data_location_id" type="number(19,0)" >
                <constraints nullable="false" />
            </column>
            <column name="rev" type="number(19,0)">
                <constraints nullable="false" />
            </column>
            <column name="revtype" type="number(3,0)"/>
            <column name="data_location" type="varchar(255)" />
            <column name="archived" type="number(1,0)" />
        </createTable>
        <addPrimaryKey tableName="output_data_location_aud" schemaName="mercury" columnNames="data_location_id, rev"/>
    </changeSet>

    <changeSet id="GPLIM-1048-3" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists columnName="run_location_id" schemaName="mercury" tableName="sequencing_run" />
            </not>
        </preConditions>

        <addColumn schemaName="mercury" tableName="sequencing_run">
            <column name="run_location_id" type="number(19,0)" />
        </addColumn>

        <addForeignKeyConstraint baseColumnNames="run_location_id" baseTableName="sequencing_run"
                                 baseTableSchemaName="mercury" referencedTableName="output_data_location"
                                 referencedColumnNames="data_location_id" referencedTableSchemaName="mercury"
                                 constraintName="fk_run_to_data_location" />
    </changeSet>
    <changeSet id="GPLIM-1048-4" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists columnName="run_location_id" schemaName="mercury" tableName="sequencing_run_aud" />
            </not>
        </preConditions>

        <addColumn schemaName="mercury" tableName="sequencing_run_aud">
            <column name="run_location_id" type="number(19,0)" />
        </addColumn>

    </changeSet>

    <changeSet id="GPLIM-1048-5" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <columnExists columnName="run_cartridges" schemaName="mercury" tableName="seq_run_run_cartridges" />
        </preConditions>

        <renameColumn tableName="seq_run_run_cartridges" oldColumnName="run_cartridges" newColumnName="run_cartridge"/>
    </changeSet>

    <changeSet id="GPLIM-1048-6" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <columnExists columnName="run_cartridges" schemaName="mercury" tableName="seq_run_run_cartridges_aud" />
        </preConditions>

        <renameColumn tableName="seq_run_run_cartridges_aud" oldColumnName="run_cartridges" newColumnName="run_cartridge"/>
    </changeSet>

    <changeSet id="GPLIM-1089-1" author="scottmat">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="idx_sequence_run_name" schemaName="mercury" />
            </not>
        </preConditions>

        <createIndex indexName="idx_sequence_run_name" tableName="sequencing_run" unique="true">
            <column name="run_name" />
        </createIndex>
    </changeSet>


    <changeSet id="GPLIM-1094-1010a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="BUCKET_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="BUCKET_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1011a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="BUCKET_ENTRY_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="BUCKET_ENTRY_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1012a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="JIRA_TICKET_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="JIRA_TICKET_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1013a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_BATCH_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_BATCH_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1017a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_EVENT_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_EVENT_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1021a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_EVENT_REAGENTS_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_EVENT_REAGENTS_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1025a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_METRIC_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_METRIC_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1026a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_METRIC_RUN_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_METRIC_RUN_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1027a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_VESSEL_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1031a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_VESSEL_CONTAINERS_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_CONTAINERS_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1035a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_VESSEL_LAB_BATCHES_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_LAB_BATCHES_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1039a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_VESSEL_MERCURY_SAMPLES_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_MERCURY_SAMPLES_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1043a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_VESSEL_NOTES_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_NOTES_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1047a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_VESSEL_RACKS_OF_TUBES_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_RACKS_OF_TUBES_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1048a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LAB_VESSEL_TICKETS_CREATED_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_TICKETS_CREATED_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1052a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LB_STARTING_LAB_VESSELS_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LB_STARTING_LAB_VESSELS_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1056a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LV_COMMENT_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LV_COMMENT_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1060a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LV_MAP_POSITION_TO_VESSEL_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LV_MAP_POSITION_TO_VESSEL_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1064a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LV_POS_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LV_POS_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1068a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LV_POS_MERCURY_SAMPLES_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LV_POS_MERCURY_SAMPLES_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1072a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="LV_REAGENT_CONTENTS_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="LV_REAGENT_CONTENTS_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1076a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="MERCURY_CONTROL_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="MERCURY_CONTROL_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1080a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="MERCURY_SAMPLE_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="MERCURY_SAMPLE_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1084a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="MOLECULAR_INDEXING_SCHEME_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="MOLECULAR_INDEXING_SCHEME_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1088a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="MOLECULAR_INDEX_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="MOLECULAR_INDEX_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1092a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="MOLECULAR_INDEX_POSITION_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="MOLECULAR_INDEX_POSITION_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1096a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="OUTPUT_DATA_LOCATION_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="OUTPUT_DATA_LOCATION_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1099a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="QUOTE_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="QUOTE_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1103a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="RAP_SHEET_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="RAP_SHEET_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1107a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="RAP_SHEET_ENTRY_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="RAP_SHEET_ENTRY_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1111a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="REAGENT_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="REAGENT_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1115a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="REAGENT_CONTAINERS_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="REAGENT_CONTAINERS_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1119a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="REAGENT_DESIGN_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="REAGENT_DESIGN_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1120a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="SEQUENCING_RUN_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="SEQUENCING_RUN_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1124a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="SEQ_RUN_RUN_CARTRIDGES_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="SEQ_RUN_RUN_CARTRIDGES_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1128a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="STATUS_NOTE_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="STATUS_NOTE_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1132a" author="epolk">
      <preConditions onFail="MARK_RAN">
	<primaryKeyExists schemaName="MERCURY" tableName="VESSEL_TRANSFER_AUD"/>
      </preConditions>
      <dropPrimaryKey schemaName="MERCURY" tableName="VESSEL_TRANSFER_AUD"/>
    </changeSet>

    <changeSet id="GPLIM-1094-1133a" author="epolk">
      <addPrimaryKey schemaName="MERCURY" tableName="BUCKET_AUD"
		     constraintName="PK_BUCKET_AUD"
		     columnNames="rev, bucket_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="BUCKET_ENTRY_AUD"
		     constraintName="PK_BUCKET_ENTRY_AUD"
		     columnNames="rev, bucket_entry_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="JIRA_TICKET_AUD"
		     constraintName="PK_JIRA_TICKET_AUD"
		     columnNames="rev, ticket_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_BATCH_AUD"
		     constraintName="PK_LAB_BATCH_AUD"
		     columnNames="rev, lab_batch_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_EVENT_AUD"
		     constraintName="PK_LAB_EVENT_AUD"
		     columnNames="rev, lab_event_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_EVENT_REAGENTS_AUD"
		     constraintName="PK_LAB_EVENT_REAGENTS_AUD"
		     columnNames="rev, lab_event, reagents"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_METRIC_AUD"
		     constraintName="PK_LAB_METRIC_AUD"
		     columnNames="rev, lab_metric_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_METRIC_RUN_AUD"
		     constraintName="PK_LAB_METRIC_RUN_AUD"
		     columnNames="rev, lab_metric_run_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_AUD"
		     constraintName="PK_LAB_VESSEL_AUD"
		     columnNames="rev, lab_vessel_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_CONTAINERS_AUD"
		     constraintName="PK_LAB_VESSEL_CONTAINERS_AUD"
		     columnNames="rev, lab_vessel, containers"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_LAB_BATCHES_AUD"
		     constraintName="PK_LAB_VESSEL_LAB_BATCHES_AU"
		     columnNames="rev, lab_vessel, lab_batches"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_MERCURY_SAMPLES_AUD"
		     constraintName="PK_LAB_VESSEL_MERCURY_SAM_AUD"
		     columnNames="rev, lab_vessel, mercury_samples"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_NOTES_AUD"
		     constraintName="PK_LAB_VESSEL_NOTES_AUD"
		     columnNames="rev, lab_vessel, notes"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_RACKS_OF_TUBES_AUD"
		     constraintName="PK_LAB_VESSEL_RACKS_OF_TUBES_A"
		     columnNames="rev, lab_vessel, racks_of_tubes"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LAB_VESSEL_TICKETS_CREATED_AUD"
		     constraintName="PK_LAB_VESSEL_TICKETS_CR_AUD"
		     columnNames="rev, lab_vessel, tickets_created"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LB_STARTING_LAB_VESSELS_AUD"
		     constraintName="PK_LB_STARTING_LAB_VESSELS_A"
		     columnNames="rev, lab_batch, starting_lab_vessels"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LV_COMMENT_AUD"
		     constraintName="PK_LV_COMMENT_AUD"
		     columnNames="rev, lab_vessel_comment_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LV_MAP_POSITION_TO_VESSEL_AUD"
		     constraintName="PK_LV_MAP_POSITION_TO_VE_AUD"
		     columnNames="rev, lab_vessel, map_position_to_vessel, mapkey"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LV_POS_AUD"
		     constraintName="PK_LV_POS_AUD"
		     columnNames="rev, lab_vessel_position_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LV_POS_MERCURY_SAMPLES_AUD"
		     constraintName="PK_LV_POS_MERCURY_SAMPLES_AU"
		     columnNames="rev, lv_pos, mercury_samples"/>
      <addPrimaryKey schemaName="MERCURY" tableName="LV_REAGENT_CONTENTS_AUD"
		     constraintName="PK_LV_REAGENT_CONTENTS_AUD"
		     columnNames="rev, lab_vessel, reagent_contents"/>
      <addPrimaryKey schemaName="MERCURY" tableName="MERCURY_CONTROL_AUD"
		     constraintName="PK_MERCURY_CONTROL_AUD"
		     columnNames="rev, mercury_control_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="MERCURY_SAMPLE_AUD"
		     constraintName="PK_MERCURY_SAMPLE_AUD"
		     columnNames="rev, mercury_sample_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="MOLECULAR_INDEXING_SCHEME_AUD"
		     constraintName="PK_MOLECULAR_INDEXING_SC_AUD"
		     columnNames="rev, molecular_indexing_scheme_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="MOLECULAR_INDEX_AUD"
		     constraintName="PK_MOLECULAR_INDEX_AUD"
		     columnNames="rev, molecular_index_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="MOLECULAR_INDEX_POSITION_AUD"
		     constraintName="PK_MOLECULAR_INDEX_POSIT_AUD"
		     columnNames="rev, scheme_id, index_id, mapkey"/>
      <addPrimaryKey schemaName="MERCURY" tableName="OUTPUT_DATA_LOCATION_AUD"
		     constraintName="PK_OUTPUT_DATA_LOCATION_AUD"
		     columnNames="rev, data_location_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="QUOTE_AUD"
		     constraintName="PK_QUOTE_AUD"
		     columnNames="rev, alphanumeric_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="RAP_SHEET_AUD"
		     constraintName="PK_RAP_SHEET_AUD"
		     columnNames="rev, rap_sheet_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="RAP_SHEET_ENTRY_AUD"
		     constraintName="PK_RAP_SHEET_ENTRY_AUD"
		     columnNames="rev, rap_sheet_entry_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="REAGENT_AUD"
		     constraintName="PK_REAGENT_AUD"
		     columnNames="rev, reagent_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="REAGENT_CONTAINERS_AUD"
		     constraintName="PK_REAGENT_CONTAINERS_AUD"
		     columnNames="rev, reagent, containers"/>
      <addPrimaryKey schemaName="MERCURY" tableName="REAGENT_DESIGN_AUD"
		     constraintName="PK_REAGENT_DESIGN_AUD"
		     columnNames="rev, reagent_design_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="SEQUENCING_RUN_AUD"
		     constraintName="PK_SEQUENCING_RUN_AUD"
		     columnNames="rev, sequencing_run_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="SEQ_RUN_RUN_CARTRIDGES_AUD"
		     constraintName="PK_SEQ_RUN_RUN_CARTRIDGES_AU"
		     columnNames="rev, sequencing_run, run_cartridge"/>
      <addPrimaryKey schemaName="MERCURY" tableName="STATUS_NOTE_AUD"
		     constraintName="PK_STATUS_NOTE_AUD"
		     columnNames="rev, status_note_id"/>
      <addPrimaryKey schemaName="MERCURY" tableName="VESSEL_TRANSFER_AUD"
		     constraintName="PK_VESSEL_TRANSFER_AUD"
		     columnNames="rev, vessel_transfer_id"/>
    </changeSet>

    <changeSet author="scottmat" id="GPLIM-1089-2">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists columnName="run_cartridge" schemaName="mercury" tableName="sequencing_run" />
            </not>
        </preConditions>
        <addColumn schemaName="mercury" tableName="sequencing_run">
            <column name="run_cartridge" type="number(19,0)" />
        </addColumn>
        <addForeignKeyConstraint baseColumnNames="run_cartridge" baseTableName="sequencing_run"
                                 baseTableSchemaName="mercury" constraintName="fk_seq_run_to_run_cartridge"
                                 referencedColumnNames="lab_vessel_id" referencedTableName="lab_vessel"
                                 referencedTableSchemaName="mercury" />
    </changeSet>

    <changeSet author="scottmat" id="GPLIM-1089-3">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists columnName="run_cartridge" schemaName="mercury" tableName="sequencing_run_aud" />
            </not>
        </preConditions>
        <addColumn schemaName="mercury" tableName="sequencing_run_aud">
            <column name="run_cartridge" type="number(19,0)" />
        </addColumn>
    </changeSet>
    <changeSet author="scottmat" id="GPLIM-1089-4">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists columnName="run_directory" schemaName="mercury" tableName="sequencing_run" />
            </not>
        </preConditions>
        <addColumn schemaName="mercury" tableName="sequencing_run">
            <column name="run_directory" type="varchar(255)" />
        </addColumn>
    </changeSet>

    <changeSet author="scottmat" id="GPLIM-1089-5">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists columnName="run_directory" schemaName="mercury" tableName="sequencing_run_aud" />
            </not>
        </preConditions>
        <addColumn schemaName="mercury" tableName="sequencing_run_aud">
            <column name="run_directory" type="varchar(255)" />
        </addColumn>
    </changeSet>

    <changeSet author="dryan" id="GPLIM-765-a01">
        <preConditions onFail="MARK_RAN">
                <indexExists indexName="SYS_C0042392" schemaName="mercury" />
        </preConditions>
        <dropUniqueConstraint constraintName="SYS_C0042392" tableName="LV_POS_MERCURY_SAMPLES" schemaName="mercury" />
    </changeSet>
    <changeSet author="scottmat" id="GPLIM-1089-6">
        <sql>
            update sequencing_run run set run.RUN_CARTRIDGE = (select runjoin.RUN_CARTRIDGE as flowcell_join
            from SEQUENCING_RUN run_view
            join SEQ_RUN_RUN_CARTRIDGES runjoin on runjoin.SEQUENCING_RUN = run_view.SEQUENCING_RUN_ID
            join lab_vessel flowcell on flowcell.LAB_VESSEL_ID = runjoin.RUN_CARTRIDGE
            where run.SEQUENCING_RUN_ID = run_view.SEQUENCING_RUN_ID) ;


            update sequencing_run_aud run set run.RUN_CARTRIDGE = (select runjoin.RUN_CARTRIDGE as flowcell_join
            from SEQUENCING_RUN_aud run_view
            join SEQ_RUN_RUN_CARTRIDGES_aud runjoin on runjoin.SEQUENCING_RUN = run_view.SEQUENCING_RUN_ID
            join lab_vessel flowcell on flowcell.LAB_VESSEL_ID = runjoin.RUN_CARTRIDGE
            where run.SEQUENCING_RUN_ID = run_view.SEQUENCING_RUN_ID) ;
        </sql>
    </changeSet>

    <changeSet author="scottmat" id="GPLIM-1089-7">
        <sql>
            update sequencing_run run set run.RUN_DIRECTORY = (select loca.DATA_LOCATION
            from sequencing_run run_view
            join OUTPUT_DATA_LOCATION loca on run_view.RUN_LOCATION_ID = loca.DATA_LOCATION_ID
            where run_view.SEQUENCING_RUN_ID = run.SEQUENCING_RUN_ID
            );

            update sequencing_run_aud run set run.RUN_DIRECTORY = (select loca.DATA_LOCATION
            from sequencing_run_aud run_view
            join OUTPUT_DATA_LOCATION_aud loca on run_view.RUN_LOCATION_ID = loca.DATA_LOCATION_ID
            where run_view.SEQUENCING_RUN_ID = run.SEQUENCING_RUN_ID
            );
        </sql>
    </changeSet>


    <changeSet id="GPLIM-1098-1" author="thompson">
        <dropTable tableName="lab_vessel_lab_batches" schemaName="mercury"/>
    </changeSet>

    <changeSet id="GPLIM-1098-2" author="thompson">
        <dropTable tableName="reagent_containers" schemaName="mercury"/>
    </changeSet>
    
    <changeSet id="GPLIM-1098-3" author="thompson">
        <createIndex schemaName="mercury" tableName="lab_event" indexName="IX_LE_IN_PLACE_LV">
            <column name="IN_PLACE_LAB_VESSEL"/>
        </createIndex>
    </changeSet>
    
    <changeSet id="GPLIM-1098-4" author="thompson">
        <createIndex schemaName="mercury" tableName="lb_starting_lab_vessels" indexName="ix_lbslv_starting_lvs">
            <column name="starting_lab_vessels"/>
        </createIndex>
    </changeSet>

    <changeSet id="GPLIM-1098-5" author="thompson">
        <dropTable tableName="lab_vessel_lab_batches_aud" schemaName="mercury"/>
    </changeSet>

    <changeSet id="GPLIM-1098-6" author="thompson">
        <dropTable tableName="reagent_containers_aud" schemaName="mercury"/>
    </changeSet>

    <changeSet id="GPLIM-765-a02" author="dryan">
        <sql splitStatements="false">
BEGIN
    FOR r IN (
        SELECT TABLE_NAME, CONSTRAINT_NAME, OWNER
            FROM USER_CONSTRAINTS
            WHERE TABLE_NAME = 'LV_POS_MERCURY_SAMPLES'
            AND CONSTRAINT_TYPE = 'U'
        )
        LOOP
            EXECUTE IMMEDIATE REPLACE(REPLACE(REPLACE(
                'ALTER TABLE #OWNER#.#TABLE# DROP CONSTRAINT #CON#' ,
            '#TABLE#',r.TABLE_NAME) ,
            '#CON#',r.CONSTRAINT_NAME),'#OWNER#',r.OWNER);
        END LOOP;
END;
        </sql>
    </changeSet>

    <changeSet id="GPLIM-1134-01" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists schemaName="mercury" tableName="lab_batch_reworks"/>
            </not>
        </preConditions>

        <createTable schemaName="mercury" tableName="lab_batch_reworks">
            <column name="lab_batch" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="reworks" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="GPLIM-1134-03" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists schemaName="mercury" tableName="lab_batch_reworks_aud"/>
            </not>
        </preConditions>

        <createTable schemaName="mercury" tableName="lab_batch_reworks_aud">
            <column name="lab_batch" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
            <column name="reworks" type="number(19,0)">
                <constraints nullable="false" />
            </column>
            <column name="revtype" type="number(3,0)">
                <constraints nullable="true"/>
            </column>
            <column name="rev" type="number(19,0)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addPrimaryKey schemaName="mercury" tableName="lab_batch_reworks_aud"
                       columnNames="rev, lab_batch, reworks" />
    </changeSet>
    <changeSet id="GPLIM-1134-04" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists schemaName="mercury" tableName="lab_batch_reworks"
                             indexName="FK_BATCH_REWORKS_BATCH"/>
            </not>
        </preConditions>
        <addForeignKeyConstraint constraintName="FK_BATCH_REWORKS_BATCH" baseTableSchemaName="mercury"
                                 baseTableName="lab_batch_reworks" baseColumnNames="lab_batch"
                                 referencedTableSchemaName="mercury" referencedTableName="lab_batch"
                                 referencedColumnNames="lab_batch_id" />
    </changeSet>
    <changeSet id="GPLIM-1134-05" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists schemaName="mercury" tableName="lab_batch_reworks"
                             indexName="FK_BATCH_VESSEL_REWORKS"/>
            </not>
        </preConditions>
        <addForeignKeyConstraint constraintName="FK_BATCH_VESSEL_REWORKS" baseTableSchemaName="mercury"
                                 baseTableName="lab_batch_reworks" baseColumnNames="reworks"
                                 referencedTableSchemaName="mercury" referencedTableName="lab_vessel"
                                 referencedColumnNames="lab_vessel_id" />
    </changeSet>
    <changeSet id="GPLIM-1134-06" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists schemaName="mercury" tableName="lab_batch_reworks_aud"
                             indexName="fk_lab_batch_reworks_rev"/>
            </not>
        </preConditions>
        <addForeignKeyConstraint constraintName="fk_lab_batch_reworks_rev" baseTableSchemaName="mercury"
                                 baseTableName="lab_batch_reworks_aud" baseColumnNames="rev"
                                 referencedTableSchemaName="mercury" referencedTableName="rev_info"
                                 referencedColumnNames="rev_info_id" />
    </changeSet>

    <changeSet id="GPLIM-1134-07" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists schemaName="mercury" tableName="rap_sheet_entry" columnName="ACTIVE_REWORK"/>
            </not>
        </preConditions>
        <addColumn schemaName="mercury" tableName="rap_sheet_entry">
            <column name="ACTIVE_REWORK" type="number(1,0)"/>
        </addColumn>
    </changeSet>
    <changeSet id="GPLIM-1134-08" author="dryan">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists schemaName="mercury" tableName="rap_sheet_entry_aud" columnName="ACTIVE_REWORK"/>
            </not>
        </preConditions>
        <addColumn schemaName="mercury" tableName="rap_sheet_entry_aud">
            <column name="ACTIVE_REWORK" type="number(1,0)"/>
        </addColumn>
    </changeSet>

    <changeSet author="scottmat" id="GPLIM-1237-1">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists schemaName="mercury" tableName="bucket_entry" columnName="STATUS" />
            </not>
        </preConditions>
        <addColumn schemaName="mercury" tableName="bucket_entry">
            <column name="STATUS" type="varchar(20)" />
        </addColumn>
    </changeSet>

    <changeSet author="scottmat" id="GPLIM-1237-2">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists schemaName="mercury" tableName="bucket_entry_aud" columnName="STATUS" />
            </not>
        </preConditions>
        <addColumn schemaName="mercury" tableName="bucket_entry_aud">
            <column name="STATUS" type="varchar(20)" />
        </addColumn>
    </changeSet>
    
    <changeSet id="GPLIM-1212-1" author="thompson">
        <dropColumn tableName="MERCURY_SAMPLE" columnName="PRODUCT_ORDER_KEY" schemaName="mercury"/>
    </changeSet>
    <changeSet id="GPLIM-1212-2" author="thompson">
        <dropColumn tableName="MERCURY_SAMPLE_AUD" columnName="PRODUCT_ORDER_KEY" schemaName="mercury"/>
    </changeSet>
    <changeSet id="GPLIM-1212-3" author="thompson">
        <addColumn tableName="bucket_entry" schemaName="mercury">
            <column name="lab_batch" type="number(19,0)"/>
        </addColumn>
    </changeSet>
    <changeSet id="GPLIM-1212-4" author="thompson">
        <addColumn tableName="bucket_entry_aud" schemaName="mercury">
            <column name="lab_batch" type="number(19,0)"/>
        </addColumn>
    </changeSet>
    <changeSet id="GPLIM-1212-5" author="thompson">
        <addForeignKeyConstraint baseTableName="bucket_entry" baseColumnNames="lab_batch" baseTableSchemaName="mercury"
                constraintName="FK_BE_LAB_BATCH"
                referencedTableName="lab_batch" referencedColumnNames="LAB_BATCH_ID" referencedTableSchemaName="mercury"/>
    </changeSet>
    <changeSet id="GPLIM-1212-6" author="thompson">
        <createIndex tableName="VESSEL_TRANSFER" indexName="IX_VT_TARGET_VESSEL">
            <column name="TARGET_VESSEL"/>
        </createIndex>
    </changeSet>

    <changeSet id="GPLIM-1325-1" author="hrafal">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="ALIGNER" schemaName="mercury"/>
            </not>
        </preConditions>
        <createTable tableName="ALIGNER" schemaName="mercury">
            <column name="ALIGNER_ID" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="NAME" type="VARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint tableName="ALIGNER" columnNames="NAME"
                             constraintName="uk_aligner_name" schemaName="mercury"/>
    </changeSet>

    <changeSet id="GPLIM-1325-2" author="hrafal">
        <preConditions>
            <not>
                <sequenceExists sequenceName="SEQ_ALIGNER" schemaName="mercury"/>
            </not>
        </preConditions>
        <createSequence sequenceName="SEQ_ALIGNER" schemaName="mercury" startValue="1" incrementBy="10"/>
    </changeSet>

    <changeSet id="GPLIM-1325-4" author="hrafal">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="ALIGNER_AUD" schemaName="mercury"/>
            </not>
        </preConditions>
        <createTable tableName="ALIGNER_AUD" schemaName="mercury">
            <column name="ALIGNER_ID" type="VARCHAR2(50)">
                <constraints nullable="true"/>
            </column>
            <column name="NAME" type="VARCHAR2(50)">
                <constraints nullable="true"/>
            </column>
            <column name="rev" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="revtype" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="GPLIM-1327-1" author="hrafal">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="REFERENCE_SEQUENCE" schemaName="mercury"/>
            </not>
        </preConditions>
        <createTable tableName="REFERENCE_SEQUENCE" schemaName="mercury">
            <column name="SEQUENCE_ID" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="NAME" type="VARCHAR2(100)">
                <constraints nullable="false"/>
            </column>
            <column name="VERSION" type="VARCHAR2(30)">
                <constraints nullable="false"/>
            </column>
            <column name="IS_CURRENT" type="BOOLEAN"/>
        </createTable>
        <addUniqueConstraint tableName="REFERENCE_SEQUENCE" columnNames="NAME, VERSION"
                             constraintName="uk_ref_sequence_name" schemaName="mercury"/>
    </changeSet>

    <changeSet id="GPLIM-1327-2" author="hrafal">
        <preConditions>
            <not>
                <sequenceExists sequenceName="SEQ_REFERENCE_SEQUENCE" schemaName="mercury"/>
            </not>
        </preConditions>
        <createSequence sequenceName="SEQ_REFERENCE_SEQUENCE" schemaName="mercury" startValue="1" incrementBy="10"/>
    </changeSet>

    <changeSet id="GPLIM-1327-4" author="hrafal">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="REFERENCE_SEQUENCE_AUD" schemaName="mercury"/>
            </not>
        </preConditions>
        <createTable tableName="REFERENCE_SEQUENCE_AUD" schemaName="mercury">
            <column name="SEQUENCE_ID" type="int">
                <constraints nullable="true"/>
            </column>
            <column name="NAME" type="VARCHAR2(50)">
                <constraints nullable="true"/>
            </column>
            <column name="VERSION" type="VARCHAR2(30)">
                <constraints nullable="true"/>
            </column>
            <column name="IS_CURRENT" type="BOOLEAN"/>
            <column name="rev" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="revtype" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="GPLIM-1328-1" author="hrafal">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="ANALYSIS_TYPE" schemaName="mercury"/>
            </not>
        </preConditions>
        <createTable tableName="ANALYSIS_TYPE" schemaName="mercury">
            <column name="ANALYSIS_TYPE_ID" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="NAME" type="VARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint tableName="ANALYSIS_TYPE" columnNames="NAME"
                             constraintName="uk_analysis_type_name" schemaName="mercury"/>
    </changeSet>

    <changeSet id="GPLIM-1328-2" author="hrafal">
        <preConditions>
            <not>
                <sequenceExists sequenceName="SEQ_ANALYSIS_TYPE" schemaName="mercury"/>
            </not>
        </preConditions>
        <createSequence sequenceName="SEQ_ANALYSIS_TYPE" schemaName="mercury" startValue="1" incrementBy="10"/>
    </changeSet>

    <changeSet id="GPLIM-1328-4" author="hrafal">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="ANALYSIS_TYPE_AUD" schemaName="mercury"/>
            </not>
        </preConditions>
        <createTable tableName="ANALYSIS_TYPE_AUD" schemaName="mercury">
            <column name="ANALYSIS_TYPE_ID" type="int">
                <constraints nullable="true"/>
            </column>
            <column name="NAME" type="VARCHAR2(50)">
                <constraints nullable="true"/>
            </column>
            <column name="rev" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="revtype" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

</databaseChangeLog>
