<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:cc="http://java.sun.com/jsf/composite"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
        >

<cc:interface>
    <cc:attribute name="barcode" required="true"/>
</cc:interface>
<cc:implementation>
    <h:outputText value="#{sampleBean.updateVessel(cc.attrs.barcode)}"/>
    <p:dataTable id="plateSampleResults" value="#{sampleBean.positionNameList}" var="positionName">
        <f:facet name="header">
            Sample Information for Container #{sampleBean.barcode}
        </f:facet>
        <p:column
                rendered="#{sampleBean.vesselContainer != null and !sampleBean.vesselContainer.hasAnonymousVessels()}">
            <f:facet name="header">
                <h:outputText value="Vessel Label"/>
            </f:facet>
        </p:column>
        <p:column
                rendered="#{sampleBean.vesselContainer != null and !sampleBean.vesselContainer.hasAnonymousVessels()}">
            <f:facet name="header">
                <h:outputText value="Vessel Type"/>
            </f:facet>
        </p:column>
        <p:column>
            <f:facet name="header">
                <h:outputText value="Sample Name"/>
            </f:facet>
        </p:column>
        <p:column>
            <f:facet name="header">
                <h:outputText value="PDOs"/>
            </f:facet>
        </p:column>
        <p:column>
            <f:facet name="header">
                <h:outputText value="Index Information"/>
            </f:facet>
        </p:column>
        <p:column>
            <f:facet name="header">
                <h:outputText value="Reagent Information"/>
            </f:facet>
        </p:column>
        <p:column>
            <f:facet name="header">
                <h:outputText value="Contained In"/>
            </f:facet>
        </p:column>
        <p:column>
            <f:facet name="header">
                <h:outputText value="Container Position"/>
            </f:facet>
        </p:column>
        <p:subTable value="#{sampleBean.getSampleInstancesAtPosition(positionName)}"
                    var="sampleInstance">
            <p:column
                    rendered="#{sampleBean.vesselContainer != null and !sampleBean.vesselContainer.hasAnonymousVessels()}">
                <h:outputText value="#{sampleBean.getVesselAtPosition(positionName).label}"/>
            </p:column>
            <p:column
                    rendered="#{sampleBean.vesselContainer != null and !sampleBean.vesselContainer.hasAnonymousVessels()}">
                <h:outputText value="#{sampleBean.getVesselAtPosition(positionName).type.name}"/>
            </p:column>
            <p:column>
                <h:outputText value="#{sampleInstance.startingSample.sampleKey}"/>
            </p:column>
            <p:column>
                <h:outputText value="#{sampleInstance.startingSample.productOrderKey}"/>
            </p:column>
            <p:column>
                <h:outputText value="#{sampleBean.indexValueForSample(sampleInstance)}"/>
            </p:column>
            <p:column>
                <h:outputText value="#{sampleBean.reagentInfoForSample(sampleInstance)}"/>
            </p:column>
            <p:column
                    rendered="#{sampleBean.vesselContainer != null and !sampleBean.vesselContainer.hasAnonymousVessels()}">
                <ui:repeat value="#{sampleBean.getVesselAtPosition(positionName).containerList}"
                           var="container">
                    <h:outputText value="#{container.embedder.label}"/>
                    <br/>
                </ui:repeat>
            </p:column>
            <p:column rendered="#{sampleBean.vesselContainer == null}">
                <ui:repeat value="#{sampleBean.vessel.containerList}"
                           var="container">
                    <h:outputText value="#{container.embedder.label}"/>
                    <br/>
                </ui:repeat>
            </p:column>
            <p:column
                    rendered="#{sampleBean.vesselContainer != null and sampleBean.vesselContainer.hasAnonymousVessels()}">
                <h:outputText value="#{sampleBean.vessel.label}"/>
            </p:column>
            <p:column
                    rendered="#{sampleBean.vesselContainer != null and !sampleBean.vesselContainer.hasAnonymousVessels()}">
                <ui:repeat value="#{sampleBean.getVesselAtPosition(positionName).containerList}"
                           var="container">
                    <h:outputText
                            value="#{container.getPositionOfVessel(sampleBean.getVesselAtPosition(positionName))}"/>
                    <br/>
                </ui:repeat>
            </p:column>
            <p:column rendered="#{sampleBean.vesselContainer == null}">
                <ui:repeat value="#{sampleBean.vessel.containerList}"
                           var="container">
                    <h:outputText
                            value="#{container.getPositionOfVessel(sampleBean.getVesselAtPosition(positionName))}"/>
                    <br/>
                </ui:repeat>
            </p:column>
            <p:column
                    rendered="#{sampleBean.vesselContainer != null and sampleBean.vesselContainer.hasAnonymousVessels()}">
                <h:outputText value="#{positionName}"/>
            </p:column>
        </p:subTable>
    </p:dataTable>
</cc:implementation>
</html>